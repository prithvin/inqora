<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
 		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
		<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css" />
		<link rel="stylesheet" type="text/css" href="CSS/cardlayout.css">
		<link rel="stylesheet" type="text/css" href="CSS/post.css">
		<link rel="stylesheet" type="text/css" href="CSS/tooltips.css">
		<link rel="stylesheet" type="text/css" href="CSS/alert.css">
		<link rel="stylesheet" type="text/css" href="CSS/companypage.css">
		<link rel="stylesheet" type="text/css" href="CSS/notifications.css">
		<link rel="stylesheet" type="text/css" href="CSS/search.css">
		<link rel="stylesheet" type="text/css" href="CSS/loginmodal.css">
		<link rel="stylesheet" type="text/css" href="CSS/messaging.css">
		<link rel="stylesheet" type="text/css" href="CSS/viewstocks.css">
		<link rel="icon" href="favicon.png" type="image/x-icon" />
		<script type="text/javascript" src="https://w.sharethis.com/button/buttons.js "></script>
		<script type="text/javascript">var switchTo5x=true;stLight.options({publisher: "3b51f3e7-db26-4944-a02f-89bcecc33f19", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>
		<style>
		.tooltips {
				display:inline;padding:0;
			}

  .picformat {
    height:50px;
    width:50px;
  }
</style>
		<title>Inqora - Create Group</title>
	</head>

	<body style="background-color: #DADFE1;">
		<div id="navsearchmainsearch" class="regularfluff row  navbar-fixed-top navbar" style="">
		<p></p>
		<div class="col-md-3 col-sm-3 hidden-xs" style="text-align:center;">
			<a href="newsfeed.html"><span class="col-xs-10 col-sm-10 col-md-offset-2 col-md-10 col-md-offset-2" style="margin-left:20px;font-size:2em;top:-2px;color:white;height:50px;"><i class="fa fa-area-chart"></i> Inqora</span></a>
		</div>
		<div class="hidden-md hidden-sm hidden-lg col-xs-2" style="">
			<a href="newsfeed.html"><span class="col-xs-10 col-sm-10 col-md-offset-2 col-md-10 col-md-offset-2" style="margin-right:5px;font-size:2em;top:2px;color:white;height:50px;"><i class="fa fa-area-chart"></i></span></a>
		</div>
		<div class="col-lg-6 col-md-5 col-sm-8 col-sm-offset-0 col-xs-9" style="">
			<form class="pure-form">
				<input id="project" placeholder="Search for Companies, Groups and People" class="col-xs-* center-block" style="width:100%;">
			</form>
		</div>

		<div class="col-xs-12 col-lg-3 col-md-4 col-sm-12" style="text-align:center;margin-bottom:10px;">
			<a onclick="document.getElementById('accountsettingsbutton').click()" class="pure-button button greenparty" ><i class="fa fa-cog"></i></a>
			<a id="myprof" class="pure-button button" style="background-color:#674172;color:white;"><i class="fa fa-user" title="My Profile"></i></a>
			<a id="admin" style="background-color:#96281B;color:white;" class="pure-button button">  <i id="numnotifs" class="fa fa-bell"> 1</i></a>
			<a id=""  onclick="window.location='messaging.html'" class="pure-button pure-button-primary button"><i class="fa fa-comment" title="Messaging"></i></a>
			<a onclick="logout()" class="hidden-xs hidden-sm pure-button button-error"><i class="fa"> Log out</i></a>
			<a onclick="logout()" class="hidden-md hidden-lg pure-button button-error"><i class="fa fa-sign-out"></i></a>
			<br>
		</div>
		<iframe id="logout" style="height:0;width:0;" frameborder="0" hidden></iframe>

			<br>
			<a id="notloggedin" href="loginpage.html" class="col-xs-12 col-md-12 col-sm-12  pure-button" style="display:none;color:white;background-color:rgba(242, 38, 19, 0.6);">Not Logged In. Limited Functionality.</a>
			<a id="verifyemailbar" href="loginpage.html" class="col-xs-12 col-md-12 col-sm-12 link pure-button" style="display:none;color:white;background-color:rgba(113, 255, 0, 0.5);">Please verify your email to access full functionality. Click here to resend email</a>
	</div>
			<div class="fixedtop" style="margin-top:10px;">
				
		
				<div style="margin-top:10px;" id="postingsystemdiv" class="col-xs-12 col-md-8 col-md-offset-2">
					<section class="post bordercard head card viewpost">
						<h1 class="align-center">Create a New Group</h1>
						<hr>
						<form id="creategroup" class="pure-form" style="width:100%;">



						<input style="width:100%;" type="text" id="Name" placeholder="Name" required><br><br>
						<input style="width:100%;" type="text" id="UserId" placeholder="Username" required><br><br>
						<textarea style="width:100%;" type="text" id="Description" placeholder="Description"></textarea><br><br>

						      Choose Below:
						  <img src="Icons/ava1.png"  class="picformat"></img>
						  <img src="Icons/ava2.png" class="picformat"></img>
						  <img src="Icons/ava3.png"  class="picformat"></img>
						  <img src="Icons/ava4.png" class="picformat"></img>
						  <img src="Icons/ava5.png"  class="picformat"></img>
						  <img id="facebookupload" class="picformat" style="display:none;"></img>
						  <img id="myupload"  class="picformat" style="display:none;"></img><br><br>
						  <div class="group" style="margin-bottom:0px;">
						      <input accept="image/*"  type="file" id="profilepic"><span ></span><span></span>
						    </div>
						  <br>
						<input type="text" id="Industry" placeholder="Industry"><br>
						<br>Make Private Group (Only Invited People Can View Posts / Content) :
						<input type="checkbox" id="isPrivate" style="font-size:2em;"><br><br>
						  <img id="thumbnail" hidden></img>
						  <img id="lolimage" hidden></img><br>
						  <input type="submit" style="width:100%;" class="pure-button pure-button-primary" value="Create Group"></input>
						</form>
					</section>
				</div>
			</div>
		</div>
	</body>
	<div id="menu">
	</div>
  <modalwindows>


  		<input id="sharethismodal" value="" style="display:none;" type="button" data-toggle="modal" data-target="#sharethis">
		<div class="modal fade" id="sharethis" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		  <div  class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" id="sharethismodalclose" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		            <center><h1 class="modal-title" id="myModalLabel"><font color="black" id="thistitleformodal">Share Post</h1></center>
		          </div>
		          <div class="modal-body" >
		          	<iframe id="sharethisframe" style="height:75%;width:75%"></iframe>
		          </div>
		      </div>
		  </div>
		</div>



		<input id="loginmodalbutton" value="" style="display:none;" type="button" data-toggle="modal" data-target="#loginmodal">
		<div class="modal fade" id="loginmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		  <div  class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" id="loginmodal" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		            <center><h1 class="modal-title" id="myModalLabel"><font color="black" id="thistitleformodal">Please Log In</h1></center>
		          </div>
		          <div class="modal-body" >
		          <div class="loginform">
		           <button id="fblogin" class="pure-button pure-button-primary" onclick="login()">Login with Facebook</button><br><br>
		          	<form id="loginform-modal-window">
<center>		          	
					  <div class="group">
					    <input class="myinput" placeholder="Username/ Email" id="username-modal-window" type="text"><span class="highlight"></span><span class="bar"></span>
		
					  </div>
					  <div class="group">
					    <input placeholder="password" class="myinput" id="password-modal-window" type="password"><span class="highlight"></span><span class="bar"></span>
					   
					  </div>
					  <button type="submit" class="loginbutton buttonBlue">Login
					    <div class="ripples buttonRipples"><span class="ripplesCircle"></span></div>
					  </button>
					</form></div>
		          </div>
		      </div>
		  </div>
		</div>


		<input id="accountsettingsbutton" value="" style="display:none;" type="button" data-toggle="modal" data-target="#accountsettings">
		<div class="modal fade" id="accountsettings" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" id="accountsettingsbuttonclose" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		            <center><h1 class="modal-title" id="myModalLabel"><font color="black" id="thistitleformodal">Account Management</h1></center>
		          </div>
		          <div class="modal-body">
					<form id="updatedetails">
						<div class="pure-menu pure-menu-open">
						    <a class="pure-menu-heading">Edit Account Settings</a>
							    <ul>
							        <li style="height:2em;">
							        	<a style="color:black;">
						        			<b>Name:</b>
						        			<span id="changename">Loading...</span>
						        			<input id="editname" style="display:none;"></input>
						        			<input id="undoname" class="pure-button undobutton" type="button" value="Undo Edit">
						        			<i style="position:relative;color:#428bca;float:right;top:-2px;" id="nameedit" class="fa fa-edit fa-2x"></i>
							        	</a>
							        </li>
							         <li style="height:2em;">
							        	<a style="color:black;">
						        			<b>Email:</b>
						        			<span id="changeemail">Loading...</span>
						        			<input type="email" id="editemail" style="display:none;" ></input>
						        			<input id="undoemail" class="pure-button undobutton" type="button" value="Undo Edit">
						        			<i style="position:relative;color:#428bca;float:right;top:-2px;" id="emailedit" class="fa fa-edit fa-2x"></i>
							        	</a>
							        </li>
							        <li style="height:2em;">
							        	<a style="color:black;">
						        			<b>Password:</b>
						        			<span id="changepassword">********</span>
						        			<input id="editpassword" style="display:none;" type="password"></input>
						        			<input id="undopassword" class="pure-button undobutton" type="button" value="Cancel">
						        			<i style="position:relative;color:#428bca;float:right;top:-2px;" id="passwordedit" class="fa fa-edit fa-2x"></i>
							        	</a>
							        </li>
							        <li >
							        	<a style="color:black;">
							        		<b>Profile Picture:</b> 
							        		<i  id="imageedit" style="position:relative;color:#428bca;float:right;top:-2px;" class="fa fa-edit fa-2x"></i>
							        		<i class="fa fa-remove fa-2x"  id="imagecancel" style="position:relative;color:#D24D57;float:right;top:-2px;display:none;"></i>
							        		<br>
							        		<center><img id="changepicture" style="height:150px;"></img></center>
							        		<div id="newpicstuff" style="display:none;">

							        			<div class="fileUpload">
													<center><canvas id="picture" width="150" height="150" ></canvas><br><br>
												    <span>New Profile Picture</span>
												    <input id="inputFileToLoad" type="file" accept="image/*" class="pure-button pure-button-primary" >
												    <input onclick="resetUploadPics()" class="pure-button" value="Default Profile Picture"></input></center>
												</div>
							        		</div>
							        	</a>
							       	</li>
							        <li class="pure-menu-heading">Update Changes</li>
							        <li><a><b>Current Password:</b> <input id="oldpass" type="password"></input></a></li>
							        <li><a href="" style="text-decoration:none;"><button style="width:90%;margin-left:5%;margin-right:5%;" type="submit"  class="pure-button pure-button-primary">Update Account Settings</button></a></li>
							    </ul>
						</div>
						 </form>
					 <canvas id="thumbnail" width="30" height="30" hidden></canvas>
					 <canvas width="150" height="150" id="lol" hidden></canvas>
					<input id="uploadFile" placeholder="Choose File" disabled="disabled" hidden/>
		          </div>
		      </div>
		  </div>
		</div>
		<div class="device-xs visible-xs"></div>
<div class="device-sm visible-sm"></div>
<div class="device-md visible-md"></div>
<div class="device-lg visible-lg"></div>
<a href="" id="bobbbb" target="_blank"></a>
	</modalwindows>
	<footer>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
		<script src="manager.js"></script>
		<script src="tooltips.js"></script>
			<script src="Javascript/fb.js"></script>
		<script src="Javascript/newsfeed.js"></script>
		<script src="Javascript/postingsystem.js"></script>
		<script src="Javascript/postinglisteners.js"></script>
		<script src="Javascript/contentparsing/linkify.js"></script>
		<script src="Javascript/contentparsing/textcomplete.js"></script>
		<script src="Javascript/contentparsing/textcompleteoverlay.js"></script>
		<script src="Javascript/newpost.js"></script>
		<script src="Javascript/displayfeed.js"></script>
		<script src="Javascript/messaging.js"></script>
		<script src="Javascript/notifications.js"></script>
		<script src="Javascript/accountsettings.js"></script>
		<script src="Javascript/totalstock.js"></script>
		<script src="Javascript/search.js"></script>
		<script src="Javascript/loginmodal.js"></script>
		<script src="Javascript/subscriptions.js"></script>
<script>
$("#creategroup").on("submit", function (ev) {
	ev.preventDefault();
	var username = document.getElementById("UserId").value;
	username = username.trim();
	if (/\s/.test(username)) {
		alert("Username cannot contain spaces");
	}
	else {
		getImageSelected (function (picdata, thumbdata, isgood) {
			if (isgood != false) {
				var request = {
					Name: document.getElementById("Name").value.trim(),
					UserID: document.getElementById("UserId").value.trim().toUpperCase(),
					Picture: picdata,
					Thumbnail: thumbdata,
					isPrivate: $("#isPrivate").get(0).checked,
					Industry: $("#Industry").val().trim(),
					Description: $("#Description").val().trim()
				};
				callAJAX("POST", "/companygroup/group/create", request, function (data) {
					alert(data);
					window.location = "grouppage.html?id=" + request.UserID;
				});
			}
		});
	}
});


  $(".picformat").on("click", function (ev) {
    $(".picformat").css("border", "0px");
    $(this).css("border", "5px solid black");
  });
  function imageToDataUri(img1, width, height, callback) {
    var img = new Image;
    img.src = img1;
    $(img).on("load", function () {
      var canvas = document.createElement('canvas'),
      ctx = canvas.getContext('2d');
      canvas.width = width;
      canvas.height = height;
      ctx.drawImage(img, 0, 0, width, height);
      if (width == 30) {
        $("#thumbnail").attr("src" ,canvas.toDataURL());
        callback ();
      }
      else {
        $("#lolimage").attr("src" ,canvas.toDataURL());
         imageToDataUri(img1, 30, 30, callback);
      }
    });
  }

  function isImage(filename) {
      var ext = filename.substring(filename.length - 3);
      switch (ext.toLowerCase()) {
        case 'jpg':
        case 'gif':
        case 'bmp':
        case 'png':
            return true;
      }
      return false;
  }
  function getURL(image, callback) {
    var src = $(image)[0].src;
    console.log(src);
    $.ajax({
      type: "GET",
      url: getLocalhost() + "/marketing/image",
      data: {
        url: src
      },
      success:function(data) {
        imageToDataUri(data, 150, 150, callback);
      },
      xhrFields: {withCredentials: true},
      error:function(){
      console.log("ERROR");
      }
    });
  }

  $("#profilepic").on("change", function () {
    var filesSelected = document.getElementById("profilepic").files;
    if (filesSelected.length > 0) {
      var fileToLoad = filesSelected[0];
      var fileReader = new FileReader();
    
      if( isImage(fileToLoad.name) == false) {
        alert("Please upload an image");
      }
      else {
        fileReader.onload = function(fileLoadedEvent) {
          var srcData = fileLoadedEvent.target.result; // <--- data: base64
          alert("Image uploaded");
          $("#myupload").attr("src", srcData)
          $("#myupload").show();
        }
      }
      fileReader.readAsDataURL(fileToLoad);
    }
  });

  function getImageSelected (callback) {
  	   var arr = document.getElementsByClassName("picformat");
      var image = -1;
      for (var x =0; x < arr.length; x++) {
        if ($(arr[x]).css("border").indexOf("5px") != -1) 
          image = arr[x];
      }
      if (image == -1) {
        alert("Must select or upload profile image");
        callback(null, null, false);
       }
      else {
        getURL(image, function () {
          canvas = document.getElementById("lolimage")
          thumbnail = document.getElementById("thumbnail");
          pictdata = canvas.src;
          thumbdata = thumbnail.src;
        	callback(pictdata, thumbdata, true);
		}); 
    } 
  }
  </script>
	</footer>
	
</html>