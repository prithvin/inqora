/*!CK:2098812842!*//*1424739961,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["d2E+5"]); }

__d("nearlyEqualNumbers",[],function(a,b,c,d,e,f){function g(h,i){if(h===i)return true;var j=Math.abs(h-i);if(j<Number.EPSILON)return true;var k=Math.abs(h),l=Math.abs(i);return j/(k+l)<Number.EPSILON;}e.exports=g;},null);
__d("GeoCoordinates",["ImmutableObject","nearlyEqualNumbers"],function(a,b,c,d,e,f,g,h){'use strict';for(var i in g)if(g.hasOwnProperty(i))k[i]=g[i];var j=g===null?null:g.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=g;function k(l,m){g.call(this,{latitude:l,longitude:m});}k.prototype.nearlyEquals=function(l){return (h(this.latitude,l.latitude)&&h(this.longitude,l.longitude));};e.exports=k;},null);
__d("LeafletView",["GeoCoordinates","ImmutableObject","invariant","nearlyEqualNumbers"],function(a,b,c,d,e,f,g,h,i,j){'use strict';for(var k in h)if(h.hasOwnProperty(k))m[k]=h[k];var l=h===null?null:h.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=h;function m(n){i(n);i(n.center instanceof g);i(typeof n.zoom==='number');h.call(this,n);}m.prototype.nearlyEquals=function(n){return (this.center.nearlyEquals(n.center)&&j(this.zoom,n.zoom));};m.prototype.setZoom=function(n){return new m({center:this.center,zoom:n});};m.DEFAULT=new m({center:new g(0,0),zoom:0});e.exports=m;},null);
__d("LeafletUtils",["GeoCoordinates","leaflet","LeafletView","TilesMapConfig","invariant","mod"],function(a,b,c,d,e,f,g,h,i,j,k,l){'use strict';var m=j.OSM_RECTS_RAW.map(function(v){return h.latLngBounds([v[2],v[1]],[v[0],v[3]]);}),n=h.CRS.EPSG3857,o=360,p=o/2,q=h.LatLng.DEG_TO_RAD,r=h.LatLng.RAD_TO_DEG,s=h.Projection.Mercator.R_MAJOR;function t(v){var w=v.zoomRange;k(Array.isArray(w)&&w.length===2);return w;}var u={fromLatLng:function(v){return new g(v.lat,v.lng);},normalizedBounds:function(v,w){var x=u.wrapLongitude(v.lng);w=h.latLng(w.lat,w.lng+x-v.lng);v=h.latLng(v.lat,x);return h.latLngBounds(v,w);},fitBounds:function(v,w,x){var y=x.crs||n,z=t(x),aa=u.getBoundsZoom(v,w,{zoomRange:z,crs:y});if(aa===null)aa=z[0];var ba=y.latLngToPoint(v.getSouthWest(),aa),ca=y.latLngToPoint(v.getNorthEast(),aa),da=u.fromLatLng(y.pointToLatLng(ba.add(ca).divideBy(2),aa));return new i({center:da,zoom:aa});},getBoundsZoom:function(v,w,x){var y=x.crs||n,z=t(x),aa=h.point(w.width,w.height),ba=v.getNorthWest(),ca=v.getSouthEast(),da=z[0]-1;for(;da<=z[1];++da){var ea=y.latLngToPoint(ca,da+1),fa=y.latLngToPoint(ba,da+1),ga=ea.subtract(fa).floor();if(!aa.contains(ga))break;}if(da<z[0])return null;if(da<=z[1])return da;return da-1;},getViewBounds:function(v,w,x){x=x||n;var y=w.width/2,z=w.height/2,aa=u.toLatLng(v.center),ba=x.latLngToPoint(aa,v.zoom),ca=x.pointToLatLng(h.point(ba.x-y,ba.y+z),v.zoom),da=x.pointToLatLng(h.point(ba.x+y,ba.y-z),v.zoom);return u.normalizedBounds(ca,da);},isViewInBounds:function(v,w,x,y){var z=u.getViewBounds(v,w,y),aa=u.shiftBoundsLng(z,o);return x.some(function(ba){return ba.contains(z)||ba.contains(aa);});},projectCircle:function(v,w,x){x=x||n;var y=v.center.latitude,z=v.center.longitude,aa=(v.radius/s)*r,ba=x.latLngToPoint(h.latLng(y+aa,z),w),ca=x.latLngToPoint(h.latLng(y-aa,z),w),da=ba.add(ca).divideBy(2),ea=x.pointToLatLng(da,w).lat,fa=y*q,ga=ea*q,ha=Math.acos((Math.cos(aa*q)-Math.sin(fa)*Math.sin(ga))/(Math.cos(fa)*Math.cos(ga)))*r,ia=isNaN(ha)?0:Math.max(Math.round(da.x-x.latLngToPoint(h.latLng(ea,z-ha),w).x),1),ja=Math.max(Math.round(da.y-ba.y),1);return {center:da,radius:h.point(ia,ja)};},shiftBoundsLng:function(v,w){return h.latLngBounds([v.getSouthWest().lat,v.getSouthWest().lng+w],[v.getNorthEast().lat,v.getNorthEast().lng+w]);},shouldShowAttribution:function(v,w,x){if(Math.min(w.height,w.width)<250)return false;if(v.zoom<j.OSM_ZOOM_THRESHOLD)return true;return !u.isViewInBounds(v,w,m,x);},toLatLng:function(v){return new h.LatLng(v.latitude,v.longitude);},wrapLongitude:function(v){return l(v+p,o)-p;}};e.exports=u;},null);
__d("KnowledgeNullableInput",["Event"],function(a,b,c,d,e,f,g){function h(i,j,k){"use strict";this.input=i;this.noValueCheckbox=j;this.noValueHiddenInput=k;this.updateInput();g.listen(j,'change',this.updateInput.bind(this));}h.prototype.updateInput=function(){"use strict";this.conditionalDisable(this.input,this.noValueCheckbox.checked);this.conditionalDisable(this.noValueHiddenInput,!this.noValueCheckbox.checked);};h.prototype.conditionalDisable=function(i,j){"use strict";if(j){this.disable(i);}else this.enable(i);};h.prototype.disable=function(i){"use strict";i.setAttribute('disabled','disabled');};h.prototype.enable=function(i){"use strict";i.removeAttribute('disabled');};e.exports=h;},null);
__d("TilesMapUtils",["CurrentLocale","GeoRectangle","TilesMapConfig"],function(a,b,c,d,e,f,g,h,i){'use strict';var j={getTileURLTemplate:function(k){if(!k)k=g.get();return i.TILE_URL_TEMPLATE+'&language='+k;},getOSMRects:function(){return j.getOSMRectsFromRaw(i.OSM_RECTS_RAW);},getOSMRectsFromRaw:function(k){return k.map(function(l){return new h(l[0],l[1],l[2],l[3]);});}};e.exports=j;},null);
__d("TilesDynamicMap",["Arbiter","ArbiterMixin","DataStore","leaflet","LeafletUtils","LeafletView","mixin","Parent","TilesMapConfig","TilesMapUtils","mod"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=m(h);for(var s in r)if(r.hasOwnProperty(s))u[s]=r[s];var t=r===null?null:r.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=r;function u(w,x,y,z,aa){"use strict";this.map=j.map(w,{center:[x.latitude,x.longitude],zoom:x.zoom||1,layers:[j.tileLayer(x.urlTemplate||p.getTileURLTemplate(x.language),{minZoom:1,maxZoom:18})],zoomControl:x.zoomControl,attributionControl:false}).on({click:function(ta){this.inform('DynamicMap/mapClick',{lat:ta.latlng.lat,lng:ta.latlng.lng},g.BEHAVIOR_PERSISTENT);}.bind(this)});var ba=x.osmRects||o.OSM_RECTS_RAW;this.osmBounds=ba.map(function(ta){return j.latLngBounds([ta[2],ta[1]],[ta[0],ta[3]]);});this.osmZoomThreshold=x.osmZoomThreshold||o.OSM_ZOOM_THRESHOLD;for(var ca=0;ca<y.length;ca++){var da=y[ca],ea=j.icon({iconUrl:da.iconUrl,iconRetinaUrl:da.iconRetinaUrl,iconSize:da.iconSize,iconAnchor:da.iconAnchor,popupAnchor:da.popupAnchor}),fa=j.marker([da.latitude,da.longitude],{draggable:da.draggable,icon:ea}).on('drag',function(ta){var ua=ta.target.getLatLng();g.inform('DynamicMap/pinDrag',{pin_id:ca,latitude:ua.lat,longitude:ua.lng},g.BEHAVIOR_PERSISTENT);});if(da.popupContent!=null){var ga={};if(da.popupMaxWidth!=null)ga.maxWidth=da.popupMaxWidth;if(da.popupMaxHeight!=null)ga.maxHeight=da.popupMaxHeight;fa.bindPopup(j.popup(ga).setContent(da.popupContent));}fa.addTo(this.map);}this.polys={};for(ca=0;ca<z.length;ca++){var ha=z[ca].points.map(function(ta){return [parseFloat(ta.latitude),parseFloat(ta.longitude)];}),ia={stroke:(z[ca].weight>0)?true:false,weight:z[ca].weight,color:z[ca].color,opacity:z[ca].opacity,fillColor:z[ca].fillColor,fillOpacity:z[ca].fillOpacity},ja=null;if(z[ca].type=='polyline'){ja=j.polyline(ha,ia);}else if(z[ca].type=='polygon')ja=j.polygon(ha,ia);if(z[ca].activeFillColor){var ka=z[ca].fillColor,la=z[ca].fillOpacity,ma=z[ca].activeFillColor,na=z[ca].activeFillOpacity;ja.on({mouseover:function(ta){ta.target.setStyle({fillColor:ma,fillOpacity:na});}.bind(this),mouseout:function(ta){ta.target.setStyle({fillColor:ka,fillOpacity:la});}.bind(this)});}if('id' in z[ca]){ja.id=z[ca].id;this.polys[ja.id]=ja;}ja.on({mouseover:function(ta){this.inform('DynamicMap/polyMouseOver',{target:ta.target},g.BEHAVIOR_PERSISTENT);}.bind(this),mouseout:function(ta){this.inform('DynamicMap/polyMouseOut',{target:ta.target},g.BEHAVIOR_PERSISTENT);}.bind(this),click:function(ta){this.inform('DynamicMap/polyClick',{target:ta.target},g.BEHAVIOR_PERSISTENT);}.bind(this)});ja.addTo(this.map);}this.circles={};for(ca=0;ca<aa.length;ca++){var oa=j.circle([aa[ca].latitude,aa[ca].longitude],aa[ca].radius,{color:aa[ca].color,weight:aa[ca].weight,opacity:aa[ca].opacity,fillColor:aa[ca].fillColor,fillOpacity:aa[ca].fillOpacity}).addTo(this.map),pa=('id' in aa[ca])?'id:'+aa[ca].id:ca;this.circles[pa]=oa;}this.subscribe('DynamicMap/setRadius',function(ta,ua){var va=null;if('id' in ua){va=this.circles['id:'+ua.id];}else{var wa=Object.keys(this.circles);if(wa.length==1)va=this.circles[wa[0]];}if(va){va.setRadius(ua.radius);if(ua.center)this.map.fitBounds(va.getBounds());}}.bind(this));if(x.logo!==null){var qa=this,ra=j.Control.extend({options:{position:'bottomleft'},initialize:function(ta){j.Util.setOptions(this,ta);},onAdd:function(ta){this.img=j.DomUtil.create('img','tilesDynamicMapLogo',this.$TilesDynamicMap0);var ua=x.logo||o.LOGO;this.img.src=ua.url;this.img.width=ua.width;this.img.height=ua.height;this.viewer=qa;ta.on('resize',this.$TilesDynamicMap1,this);this.$TilesDynamicMap1({newSize:ta.getSize()});return this.img;},$TilesDynamicMap1:function(ta){if(ta.newSize.x<250||ta.newSize.y<250){this.img.hidden=true;}else this.img.hidden=this.viewer.$TilesDynamicMap2();}}),sa=new ra();this.map.on('moveend',function(){sa.img.hidden=this.$TilesDynamicMap2();},this);this.map.addControl(sa);}i.set(w,'TilesDynamicMap',this);this.inform('DynamicMap/onInit',{},g.BEHAVIOR_PERSISTENT);}u.prototype.on=function(w,x){"use strict";this.map.on(w,x);};u.prototype.off=function(w,x){"use strict";this.map.off(w,x);};u.prototype.fitBounds=function(w){"use strict";this.map.fitBounds(w);};u.prototype.getCenter=function(){"use strict";var w=this.map.getCenter();return {latitude:w.lat,longitude:w.lng};};u.prototype.getZoom=function(){"use strict";return this.map.getZoom();};u.prototype.getWidth=function(){"use strict";return this.map.getSize().x;};u.prototype.getHeight=function(){"use strict";return this.map.getSize().y;};u.prototype.invalidateSize=function(){"use strict";this.map.invalidateSize(false);};u.prototype.setView=function(w){"use strict";if(w.centerOffset){var x=this.map.project(w.center,w.zoom);x=x.subtract(w.centerOffset);w.center=this.map.unproject(x,w.zoom);}this.map.setView(w.center,w.zoom,{animate:w.animate});this.map.fireEvent('movestart');this.map.fireEvent('moveend');};u.prototype.poly=function(w){"use strict";return this.polys[w];};u.prototype.onInit=function(w){"use strict";w();};u.prototype.getMicrosoftMaps=function(){"use strict";return new v(this);};u.prototype.getMap=function(){"use strict";return this;};u.prototype.mapToPixel=function(w){"use strict";var x=this.map.getPixelBounds().min;return w.sub(x.x,x.y);};u.prototype.pixelToMap=function(w){"use strict";var x=this.map.getPixelBounds().min,y=w.add(x.x,x.y);y.x=q(y.x,this.$TilesDynamicMap3());return y;};u.prototype.tryPixelToLocation=function(w){"use strict";return this.map.containerPointToLatLng(w);};u.prototype.$TilesDynamicMap3=function(){"use strict";return 512*Math.pow(2,this.map.getZoom()-1);};u.prototype.$TilesDynamicMap2=function(){"use strict";if(this.map.getZoom()<this.osmZoomThreshold)return false;var w=this.map.getSize();return k.isViewInBounds(new l({center:k.fromLatLng(this.map.getCenter()),zoom:this.map.getZoom()}),{width:w.x,height:w.y},this.osmBounds);};u.getInstance=function(w){"use strict";var x=n.byClass(w,'tilesDynamicMap');return x?i.get(x,'TilesDynamicMap'):null;};u.poke=function(w){"use strict";var x=u.getInstance(w);x&&x.invalidateSize();};function v(w){"use strict";this.map=w;this.Events={addHandler:function(x,y,z){if(y==='viewchange'){y='movestart move';}else if(y==='viewchangeend')y='moveend';var aa=function(ba){z({getX:function(){return ba.containerPoint.x;},getY:function(){return ba.containerPoint.y;}});};x.on(y,aa);return {map:x,evt:y,fn:aa};},removeHandler:function(x){x.map.off(x.evt,x.fn);}};this.Point=j.point;this.Location=j.LatLng;this.PixelReference={control:null};}e.exports=u;},null);
__d("KnowledgeEditRow",["cx","CSS","DOMQuery","Event","ScrollableArea","TilesDynamicMap"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={init:function(n,o,p,q){var r=j.listen(n,'click',function(){if(q){q.show();}else m.expand(n,o,p);});if(q)q.subscribe('confirm',function(){m.expand(n,o,p);q.hide();r.remove();});},expand:function(n,o,p){h.hide(o);h.show(p);h.removeClass(n,"_54cv");i.scry(p,'.uiScrollableArea').forEach(function(q){k.poke(q);});i.scry(p,'.tilesDynamicMap').forEach(function(q){l.poke(q);});},copyOnConfirm:function(n,o,p){n.subscribe('confirm',function(){p.value=o.getPageName();});}};e.exports=m;},null);